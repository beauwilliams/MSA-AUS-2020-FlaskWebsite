var rxline=function(n,u,c){"use strict";function r(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function o(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function t(n,e,t){return e&&o(n.prototype,e),t&&o(n,t),n}function a(n){return function(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=function(){function n(t){r(this,n),this.op$=function(n){try{var e=t(n);return e instanceof Promise?u.from(e):e instanceof u.Observable?e:u.of(e)}catch(n){return u.throwError(n)}}}return t(n,[{key:"combine",value:function(e){var t=this;return e instanceof n?new n(function(n){return t.op$(n).pipe(c.concatMap(e.op$))}):this.combine(new n(e))}},{key:"apply",value:function(n){return this.op$(n)}}]),n}();function e(){return new i(function(n){return n})}function f(n){return new i(n)}var s=function(){function e(n){r(this,e),this.func=n}return t(e,[{key:"modify",value:function(n){return this.func(n)}}]),e}();function p(n){return new s(n)}function l(n,e){return n.pipe(c.concatMap(e.op$))}function v(n,e){return n.pipe(c.mergeMap(e.op$))}function h(e){return f(function(n){return e(n),n})}var m=function(n,u,c,a){return new(c=c||Promise)(function(t,e){function r(n){try{i(a.next(n))}catch(n){e(n)}}function o(n){try{i(a.throw(n))}catch(n){e(n)}}function i(n){var e;n.done?t(n.value):((e=n.value)instanceof c?e:new c(function(n){n(e)})).then(r,o)}i((a=a.apply(n,u||[])).next())})};function y(r){var n=this;return f(function(t){return u.Observable.create(function(e){m(n,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r(t);case 3:if(!n.sent){n.next=5;break}e.next(t);case 5:e.complete(),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),e.error(n.t0);case 11:case"end":return n.stop()}},n,null,[[0,8]])}))})})}var b=function(n,u,c,a){return new(c=c||Promise)(function(t,e){function r(n){try{i(a.next(n))}catch(n){e(n)}}function o(n){try{i(a.throw(n))}catch(n){e(n)}}function i(n){var e;n.done?t(n.value):((e=n.value)instanceof c?e:new c(function(n){n(e)})).then(r,o)}i((a=a.apply(n,u||[])).next())})},w=function(){function o(n,e){r(this,o),this.transform=e,n instanceof u.Observable?this.content$=n:n instanceof Promise?this.content$=u.from(n).pipe(c.flatMap(u.from)):this.content$=u.from(n)}return t(o,[{key:"pipe",value:function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.reduce(function(n,e){return n._pipe(e)},this)}},{key:"_pipe",value:function(n){return new o(this.content$,n instanceof i?this.transform.combine(n):n instanceof s?n.modify(this.transform):this.transform.combine(new i(n)))}},{key:"pick",value:function(n){return this.pipe(y(n))}},{key:"drop",value:function(t){var n=this;return this.pipe(y(function(e){return b(n,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t(e);case 2:return n.abrupt("return",!n.sent);case 3:case"end":return n.stop()}},n)}))}))}},{key:"peek",value:function(n){return this.pipe(h(n))}},{key:"funnel",value:function(n){return n(this)}},{key:"process",value:function(n){var t=this,r=0<arguments.length&&void 0!==n?n:l;return new o(new Promise(function(n,e){r(t.content$,t.transform).pipe(c.toArray()).subscribe({next:n,error:e})}),e())}},{key:"prep",value:function(n){return new o((0<arguments.length&&void 0!==n?n:l)(this.content$,this.transform),e())}},{key:"collect",value:function(n,e,t){var r=e?n:l;return this.prep(r).content$.pipe(c.toArray()).subscribe(e||n,t)}}]),o}();function d(n){return new w(n,e())}function g(n,r){var o={},e=n.prep().content$.pipe(c.share());return d(u.Observable.create(function(t){e.subscribe({next:function(n){var e=r(n).toString();e in o||(o[e]=new u.ReplaySubject,t.next(d(o[e]))),o[e].next(n)},error:function(e){t.error(e),Object.values(o).forEach(function(n){return n.error(e)})},complete:function(){t.complete(),Object.values(o).forEach(function(n){return n.complete()})}})}))}return n.Line=w,n.Modifier=s,n.Transform=i,n.concat=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return d(u.concat.apply(void 0,a(e.map(function(n){return n.prep(l).content$}))))},n.concurrently=v,n.filter=y,n.handleError=function(r){return p(function(e){return new i(function(t){var n=e.apply(t);return u.Observable.create(function(e){n.subscribe({next:function(n){return e.next(n)},error:function(n){r(n,t,function(n){return e.error(n)}),e.complete()},complete:function(){return e.complete()}})})})})},n.identity=e,n.line=d,n.merge=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return d(u.merge.apply(void 0,a(e.map(function(n){return n.prep(v).content$}))))},n.mod=p,n.mod$=function(t){return p(function(e){return new i(function(n){return e.apply(n).pipe(t)})})},n.partition=function(e,n){return n?g(e,n):function(n){return g(n,e)}},n.reduce=function(i){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return function(n){return new Promise(function(e,t){n.collect(function(n){var o=r;u.concat.apply(void 0,a(n.map(function(r){return u.Observable.create(function(e){function n(n){o=n,e.complete()}var t=i(o,r);t instanceof u.Observable?t.pipe(c.last()).subscribe(n):t instanceof Promise?t.then(n):n(t)})}))).subscribe(void 0,function(n){return t(n)},function(){return e(o)})})})}},n.sequentially=l,n.tap=h,n.transform=f,n}({},rxjs,rxjs.operators);
