var rxline=function(e,n,t){"use strict";class r{constructor(e){this.op$=t=>{try{const r=e(t);return r instanceof Promise?n.from(r):r instanceof n.Observable?r:n.of(r)}catch(e){return n.throwError(e)}}}combine(e){return e instanceof r?new r(n=>this.op$(n).pipe(t.concatMap(e.op$))):this.combine(new r(e))}apply(e){return this.op$(e)}}function o(){return new r(e=>e)}function c(e){return new r(e)}class i{constructor(e){this.func=e}modify(e){return this.func(e)}}function s(e){return new i(e)}function u(e,n){return e.pipe(t.concatMap(n.op$))}function a(e,n){return e.pipe(t.mergeMap(n.op$))}function p(e){return c(n=>(e(n),n))}var f=function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function i(e){try{u(r.next(e))}catch(e){c(e)}}function s(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}u((r=r.apply(e,n||[])).next())}))};function l(e){return c(t=>n.Observable.create(n=>{(()=>{f(this,void 0,void 0,(function*(){try{(yield e(t))&&n.next(t),n.complete()}catch(e){n.error(e)}}))})()}))}var h=function(e,n,t,r){return new(t||(t=Promise))((function(o,c){function i(e){try{u(r.next(e))}catch(e){c(e)}}function s(e){try{u(r.throw(e))}catch(e){c(e)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}u((r=r.apply(e,n||[])).next())}))};class m{constructor(e,r){this.transform=r,e instanceof n.Observable?this.content$=e:this.content$=e instanceof Promise?n.from(e).pipe(t.flatMap(n.from)):n.from(e)}pipe(...e){return e.reduce((e,n)=>e._pipe(n),this)}_pipe(e){return new m(this.content$,e instanceof r?this.transform.combine(e):e instanceof i?e.modify(this.transform):this.transform.combine(new r(e)))}pick(e){return this.pipe(l(e))}drop(e){return this.pipe(l(n=>h(this,void 0,void 0,(function*(){return!(yield e(n))}))))}peek(e){return this.pipe(p(e))}funnel(e){return e(this)}process(e=u){return new m(new Promise((n,r)=>{e(this.content$,this.transform).pipe(t.toArray()).subscribe({next:n,error:r})}),o())}prep(e=u){return new m(e(this.content$,this.transform),o())}collect(e,n,r){const o=n?e:u;return this.prep(o).content$.pipe(t.toArray()).subscribe(n||e,r)}}function b(e){return new m(e,o())}function v(e,r){const o={},c=e.prep().content$.pipe(t.share());return b(n.Observable.create(e=>{c.subscribe({next:t=>{const c=r(t).toString();c in o||(o[c]=new n.ReplaySubject,e.next(b(o[c]))),o[c].next(t)},error:n=>{e.error(n),Object.values(o).forEach(e=>e.error(n))},complete:()=>{e.complete(),Object.values(o).forEach(e=>e.complete())}})}))}return e.Line=m,e.Modifier=i,e.Transform=r,e.concat=function(...e){return b(n.concat(...e.map(e=>e.prep(u).content$)))},e.concurrently=a,e.filter=l,e.handleError=function(e){return s((function(t){return new r(r=>{const o=t.apply(r);return n.Observable.create(n=>{o.subscribe({next:e=>n.next(e),error:t=>{e(t,r,e=>n.error(e)),n.complete()},complete:()=>n.complete()})})})}))},e.identity=o,e.line=b,e.merge=function(...e){return b(n.merge(...e.map(e=>e.prep(a).content$)))},e.mod=s,e.mod$=function(e){return s(n=>new r(t=>n.apply(t).pipe(e)))},e.partition=function(e,n){return n?v(e,n):n=>v(n,e)},e.reduce=function(e,r=0){return o=>new Promise((c,i)=>{o.collect(o=>{let s=r;n.concat(...o.map(r=>n.Observable.create(o=>{let c=e(s,r);const i=e=>{s=e,o.complete()};c instanceof n.Observable?c.pipe(t.last()).subscribe(i):c instanceof Promise?c.then(i):i(c)}))).subscribe(void 0,e=>i(e),()=>c(s))})})},e.sequentially=u,e.tap=p,e.transform=c,e}({},rxjs,rxjs.operators);
