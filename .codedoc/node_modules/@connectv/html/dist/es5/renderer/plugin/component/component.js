"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var plugin_1 = require("../plugin");
var basic_plugins_1 = require("./basic-plugins");
var types_1 = require("./types");
var ComponentPlugin = /** @class */ (function () {
    function ComponentPlugin() {
        this.priority = plugin_1.PluginPriority.High;
    }
    ComponentPlugin.prototype.create = function (tag, props, children, host) {
        if (typeof tag === 'function') {
            var compFunc_1 = tag;
            var extras_1 = {};
            var _props_1 = props || {};
            var post = host.plugins
                .filter(basic_plugins_1.isCompProcessPlugin)
                .map(function (plugin) { return plugin.prepare(compFunc_1, _props_1, children, extras_1, host); });
            var _res_1;
            if (types_1.isCompClass(compFunc_1)) {
                var comp = new compFunc_1(_props_1, children, extras_1);
                _res_1 = comp.render(host);
                if (_props_1 && _props_1._ref)
                    _props_1._ref.resolve(comp);
            }
            else
                _res_1 = compFunc_1.apply(extras_1, [_props_1, host, children]);
            post.reverse().forEach(function (p) { if (p)
                p(_res_1); });
            return _res_1;
        }
        else
            return undefined;
    };
    return ComponentPlugin;
}());
exports.ComponentPlugin = ComponentPlugin;
//# sourceMappingURL=component.js.map