import { Observable } from 'rxjs';
import { tap } from 'rxjs/operators';
import * as L from '../../../shared/life-cycle';
import { polyfillCustomEvent } from '../util/custom-event.polyfill';
import { PluginPriority } from "../plugin";
import trackable from './trackable';
export class CompOutputObservableEventsPlugin {
    constructor() {
        this.priority = PluginPriority.High;
    }
    wire(node, signature) {
        if (!(node instanceof DocumentFragment) && signature.outputs) {
            polyfillCustomEvent();
            Object.entries(signature.outputs).forEach(([name, output]) => {
                if (output instanceof Observable)
                    L.attach(trackable(output.pipe(tap(value => node.dispatchEvent(new CustomEvent(name, { detail: { value } }))))), node);
            });
        }
    }
}
//# sourceMappingURL=comp-output-observable-events.js.map