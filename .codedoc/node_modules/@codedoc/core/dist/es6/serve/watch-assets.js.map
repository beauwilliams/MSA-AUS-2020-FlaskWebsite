{"version":3,"file":"watch-assets.js","sourceRoot":"","sources":["../../../src/serve/watch-assets.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,MAAM,YAAY,CAAC;AAC/B,OAAO,EAAE,IAAI,EAAE,MAAM,MAAM,CAAC;AAC5B,OAAO,EAAE,OAAO,EAAmB,MAAM,MAAM,CAAC;AAChD,OAAO,EAAE,YAAY,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AAGtD,OAAO,EAAU,sBAAsB,EAAE,MAAM,UAAU,CAAC;AAG1D,MAAM,gBAAgB,GAAG;IACvB,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO;IAChD,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM;IACzC,MAAM,CAA4C,kBAAkB;CACrE,CAAC;AAEF,MAAM,UAAU,WAAW,CAAC,IAAY,EAAE,MAAqB,EAAE,KAAwC;IACvG,MAAM,OAAO,GAAG,IAAI,OAAO,EAAU,CAAC;IAEtC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;QACpC,SAAS,EAAE,IAAI;QACf,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;KACrF,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;IAE5C,OAAO,OAAO,CAAC,IAAI,CACjB,YAAY,CAAC,EAAE,CAAC,EAChB,MAAM,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,KAAK,sBAAsB,CAAC,CAC5D,CAAC;AACJ,CAAC","sourcesContent":["import watch from 'node-watch';\nimport { join } from 'path';\nimport { Subject, BehaviorSubject } from 'rxjs';\nimport { debounceTime, filter } from 'rxjs/operators';\n\nimport { CodedocConfig } from '../config';\nimport { Status, StatusBuildingResponse } from './config';\n\n\nconst ASSET_EXTENSIONS = [\n  '.jpg', '.jpeg', '.png', '.gif', '.svg', '.webp', // --> images\n  '.woff', '.woff2', '.ttf', '.otf', '.eot',        // --> fonts\n  '.css'                                            // --> stylesheets\n];\n\nexport function watchAssets(root: string, config: CodedocConfig, state: BehaviorSubject<{status: Status}>) {\n  const change$ = new Subject<string>();\n\n  watch(join(root, config.dest.assets), {\n    recursive: true,\n    filter: f => ASSET_EXTENSIONS.some(extension => f.toLowerCase().endsWith(extension))\n  }, (_, filename) => change$.next(filename));\n\n  return change$.pipe(\n    debounceTime(10),\n    filter(() => state.value.status !== StatusBuildingResponse)\n  );\n}\n"]}