{"version":3,"file":"switcher.js","sourceRoot":"","sources":["../../../../../../../src/components/page/toc/search/post-nav/switcher.tsx"],"names":[],"mappings":"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","sourcesContent":["import { state } from '@connectv/core';\nimport { RendererLike, ref } from '@connectv/html';\nimport { ThemedComponentThis } from '@connectv/jss-theme';\n\nimport { CodedocTheme } from '../../../../../theme';\nimport { SearchSwitcherStyles } from './styles';\n\n\nexport interface SearchSwitcherOptions {\n  elements: HTMLElement[];\n  query: string;\n}\n\n\nexport function SearchSwitcher(\n  this: ThemedComponentThis<CodedocTheme>,\n  options: SearchSwitcherOptions,\n  renderer: RendererLike<any, any>\n) {\n  const classes = this.theme.classes(SearchSwitcherStyles);\n\n  const holder = ref<HTMLElement>();\n  const index = state(1);\n  let focused: HTMLElement | undefined = undefined;\n\n  const focus = (element: HTMLElement) => {\n    if (focused) focused.style.transform = '';\n    element.style.transform = 'scale(1.15)';\n    focused = element;\n    let delay = 1;\n\n    let parent = focused.parentElement;\n    while (parent) {\n      if (parent.hasAttribute('data-tab-title')) {\n        if (!parent.classList.contains('selected')) {\n          const ref = parent.getAttribute('data-tab-title');\n          const btn$ = parent\n                        .parentElement\n                        ?.querySelector(`.selector>button[data-tab-title=\"${ref}\"]`);\n          if (btn$) {\n            (btn$ as HTMLButtonElement).click();\n            delay = 300;\n          }\n        }\n      }\n\n      parent = parent.parentElement;\n    }\n\n    setTimeout(() => focused?.scrollIntoView({ block: 'center' }), delay);\n  }\n\n  const next = () => {\n    if (index.value >= options.elements.length) index.value = 1;\n    else index.value++;\n\n    focus(options.elements[index.value - 1]);\n  }\n\n  const prev = () => {\n    if (index.value <= 1) index.value = options.elements.length;\n    else index.value --;\n\n    focus(options.elements[index.value - 1]);\n  }\n\n  const keyhandler = (event: KeyboardEvent) => {\n    if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') prev();\n    if (event.key === 'ArrowRight' || event.key === 'ArrowDown') next();\n    if (event.key === 'Escape') {\n      holder.$.remove();\n      event.preventDefault();\n    }\n  };\n\n  this.track({\n    bind() {\n      document.addEventListener('keydown', keyhandler);\n      focus(options.elements[0]);\n    },\n\n    clear() {\n      document.removeEventListener('keydown', keyhandler);\n      options.elements.forEach(element => {\n        renderer.render(<fragment>{element.textContent}</fragment>).before(element);\n        element.remove();\n      });\n    }\n  })\n\n  return <div class={classes.holder} _ref={holder}>\n    <span class=\"icon-font\" onclick={() => holder.$.remove()}>close</span>\n    <span class=\"icon-font\" onclick={() => {\n      localStorage.setItem('-codedoc-search-query', options.query);\n      document.getElementById('-codedoc-search-btn')?.click()\n    }}>list</span>\n    <span class={classes.content}>\n      {options.elements.length > 0 ? \n        <fragment>{index}/{options.elements.length}</fragment> :\n        'No Exact Match'\n      }\n    </span>\n    <span class=\"icon-font\" onclick={prev}>chevron_left</span>\n    <span class=\"icon-font\" onclick={next}>chevron_right</span>\n  </div>;\n}\n"]}