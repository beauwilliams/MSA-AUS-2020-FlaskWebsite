{"version":3,"file":"highlight.js","sourceRoot":"","sources":["../../../../../src/components/page/contentnav/highlight.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,yBAAyB,CAAC;AAGjE,MAAM,UAAU,mBAAmB;IACjC,OAAO,CAAC,GAAG,EAAE;QACX,IAAI,KAAK,GAA2C,EAAE,CAAC;QAEvD,MAAM,KAAK,GAAG,GAAG,EAAE;YACjB,KAAK,GAAG,EAAE,CAAC;YACX,QAAQ,CAAC,gBAAgB,CAAC,2BAA2B,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBACnE,IAAI,EAAE,GAAG,GAAkB,CAAC;gBAC5B,MAAM,EAAE,GAAG,EAAE,CAAC,YAAY,CAAC,wBAAwB,CAAC,CAAC;gBACrD,IAAI,EAAE,EAAE;oBACN,MAAM,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;oBACzC,IAAI,IAAI,EAAE;wBACR,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC;qBAC1B;iBACF;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,KAAK,EAAE,CAAC;QAAC,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QAEtD,SAAS,MAAM;;YACb,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,IAAI,MAA+B,CAAC;YAEpC,KAAK,CAAC,OAAO,CAAC,CAAC,EAAC,EAAE,EAAE,IAAI,EAAC,EAAE,EAAE;gBAC3B,MAAM,GAAG,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC,GAAG,CAAC;gBAC7C,IAAI,GAAG,GAAG,MAAM,CAAC,WAAW,GAAG,EAAE,IAAI,GAAG,GAAG,CAAC,EAAE;oBAC5C,QAAQ,GAAG,KAAK,CAAC;oBACjB,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;iBAC5B;qBACI;oBACH,IAAI,GAAG,GAAG,CAAC;wBAAE,MAAM,GAAG,EAAE,CAAC;oBACzB,EAAE,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;iBAC/B;YACH,CAAC,CAAC,CAAC;YAEH,IAAI,QAAQ;gBAAE,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE;YAE9C,MAAM,MAAM,SAAG,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,0CAAE,EAAE,CAAC;YACtE,IAAI,MAAM,EAAE;gBACV,MAAM,MAAM,GAAG,MAAM,CAAC,aAA4B,CAAC;gBACnD,IAAI,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY,EAAE;oBAC9C,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,YAAY,GAAG,CAAC,CAAC;iBAC/D;aACF;QACH,CAAC;QAED,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACpB,MAAM,EAAE,CAAC;YACT,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,EAAE,GAAG,EAAE,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;YACjE,MAAM,CAAC,gBAAgB,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;SAC/C;IACH,CAAC,CAAC,CAAC;AACL,CAAC;AAGD,MAAM,CAAC,MAAM,oBAAoB,GAAG,aAAa,CAAA,aAAa,CAAC,mBAAmB,CAAC,CAAC","sourcesContent":["import { funcTransport, onReady } from '@connectv/sdh/transport';\n\n\nexport function contentNavHighlight() {\n  onReady(() => {\n    let links: {a$: HTMLElement, ref$: HTMLElement}[] = [];\n\n    const _exec = () => {\n      links = [];\n      document.querySelectorAll('a[data-content-highlight]').forEach(_a$ => {\n        let a$ = _a$ as HTMLElement;\n        const id = a$.getAttribute('data-content-highlight');\n        if (id) {\n          const ref$ = document.getElementById(id);\n          if (ref$) {\n            links.push({ a$, ref$ });\n          }\n        }\n      });\n    };\n\n    _exec(); window.addEventListener('navigation', _exec);\n\n    function update() {\n      let noactive = true;\n      let latest: HTMLElement | undefined;\n\n      links.forEach(({a$, ref$}) => {\n        const top = ref$.getBoundingClientRect().top;\n        if (top < window.innerHeight - 96 && top > 0) {\n          noactive = false;\n          a$.classList.add('active');\n        }\n        else {\n          if (top < 0) latest = a$;\n          a$.classList.remove('active');\n        }\n      });\n\n      if (noactive) latest?.classList.add('active');\n\n      const target = links.find(l => l.a$.classList.contains('active'))?.a$;\n      if (target) {\n        const parent = target.parentElement as HTMLElement;\n        if (parent.scrollHeight != parent.offsetHeight) {\n          parent.scrollTop = target.offsetTop - parent.offsetHeight / 3;\n        }\n      }\n    }\n\n    if (links.length > 0) {\n      update();\n      document.addEventListener('scroll', () => setTimeout(update, 1));\n      window.addEventListener('navigation', update);\n    }\n  });\n}\n\n\nexport const contentNavHighlight$ = /*#__PURE__*/funcTransport(contentNavHighlight);\n"]}